<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>服裝訂購表單</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }
        h1, h2 {
            text-align: center;
        }
        .form-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, select {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .order-item {
            background-color: #f9f9f9;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            position: relative;
        }
        .remove-btn {
            background-color: #ff4d4d;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 5px 10px;
            cursor: pointer;
            position: absolute;
            right: 10px;
            top: 10px;
        }
        button {
            padding: 10px 15px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
        }
        button:hover {
            background-color: #45a049;
        }
        .total-price {
            font-size: 18px;
            font-weight: bold;
            text-align: right;
            margin-top: 20px;
        }
        .image-slider {
            width: 100%;
            overflow-x: auto;
            white-space: nowrap;
            margin-bottom: 20px;
        }
        .image-slider img {
            width: 150px;
            height: 150px;
            margin-right: 10px;
            object-fit: cover;
            display: inline-block;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <div class="form-container">
        <h1>服裝訂購表單</h1>
        
        <!-- 產品資訊表格 -->
        <h2>衣服款式資訊</h2>
        <table>
            <thead>
                <tr>
                    <th>款式</th>
                    <th>顏色</th>
                    <th>尺寸</th>
                    <th>價格</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>台ㄕ大</td>
                    <td>黑, 白</td>
                    <td>S, M, L, XL, 2XL</td>
                    <td>$450</td>
                </tr>
                <tr>
                    <td>台灣吃飯大學 舊款</td>
                    <td>黑, 白, 灰</td>
                    <td>S, M, L, XL, 2XL</td>
                    <td>$590</td>
                </tr>
                <tr>
                    <td>台灣吃飯大學 新款</td>
                    <td>黑, 白, 灰</td>
                    <td>S, M, L, XL, 2XL</td>
                    <td>$590</td>
                </tr>
                <tr>
                    <td>台灣吃飯大學帆布袋</td>
                    <td>白</td>
                    <td>統一尺寸</td>
                    <td>$250</td>
                </tr>
                <tr>
                    <td>勝利的精子</td>
                    <td>白</td>
                    <td>S, M, L, XL, 2XL</td>
                    <td>$550</td>
                </tr>
            </tbody>
        </table>

        <!-- 圖片輪播 -->
        <h2>款式展示</h2>
        <div class="image-slider">
            <!-- 這裡會放置產品圖片，目前使用預設圖片 -->
            <img src="/api/placeholder/150/150" alt="台ㄕ大-黑色">
            <img src="/api/placeholder/150/150" alt="台ㄕ大-白色">
            <img src="/api/placeholder/150/150" alt="台灣吃飯大學舊款-黑色">
            <img src="/api/placeholder/150/150" alt="台灣吃飯大學舊款-白色">
            <img src="/api/placeholder/150/150" alt="台灣吃飯大學舊款-灰色">
            <img src="/api/placeholder/150/150" alt="台灣吃飯大學新款-黑色">
            <img src="/api/placeholder/150/150" alt="台灣吃飯大學新款-白色">
            <img src="/api/placeholder/150/150" alt="台灣吃飯大學新款-灰色">
            <img src="/api/placeholder/150/150" alt="台灣吃飯大學帆布袋-白色">
            <img src="/api/placeholder/150/150" alt="勝利的精子-白色">
        </div>

        <!-- 個人資料表單 -->
        <h2>個人資料</h2>
        <form id="orderForm">
            <div class="form-group">
                <label for="name">姓名</label>
                <input type="text" id="name" name="name" required>
            </div>
            <div class="form-group">
                <label for="phone">電話</label>
                <input type="tel" id="phone" name="phone" required>
            </div>
            <div class="form-group">
                <label for="department">系級</label>
                <input type="text" id="department" name="department" required>
            </div>
            <div class="form-group">
                <label for="lineId">Line ID</label>
                <input type="text" id="lineId" name="lineId" required>
            </div>
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" required>
            </div>

            <!-- 訂單項目 -->
            <h2>訂購項目</h2>
            <div id="orderItems">
                <!-- 訂單項目會動態加入這裡 -->
            </div>

            <!-- 新增訂單項目表單 -->
            <div class="form-group">
                <label for="style">款式</label>
                <select id="style" name="style">
                    <option value="">請選擇款式</option>
                    <option value="台ㄕ大">台ㄕ大</option>
                    <option value="台灣吃飯大學 舊款">台灣吃飯大學 舊款</option>
                    <option value="台灣吃飯大學 新款">台灣吃飯大學 新款</option>
                    <option value="台灣吃飯大學帆布袋">台灣吃飯大學帆布袋</option>
                    <option value="勝利的精子">勝利的精子</option>
                </select>
            </div>
            <div class="form-group">
                <label for="color">顏色</label>
                <select id="color" name="color" disabled>
                    <option value="">請先選擇款式</option>
                </select>
            </div>
            <div class="form-group">
                <label for="size">尺寸</label>
                <select id="size" name="size" disabled>
                    <option value="">請先選擇款式</option>
                </select>
            </div>
            <div class="form-group">
                <label for="quantity">數量</label>
                <input type="number" id="quantity" name="quantity" min="1" value="1" disabled>
            </div>

            <button type="button" id="addItem">加入訂購項目</button>

            <!-- 總金額 -->
            <div class="total-price">總金額: $<span id="totalPrice">0</span></div>

            <button type="button" id="submitOrder">提交訂單</button>
        </form>
    </div>

    <script>
        // 商品資料定義
        const products = {
            "台ㄕ大": {
                colors: ["黑", "白"],
                sizes: ["S", "M", "L", "XL", "2XL"],
                price: 450
            },
            "台灣吃飯大學 舊款": {
                colors: ["黑", "白", "灰"],
                sizes: ["S", "M", "L", "XL", "2XL"],
                price: 590
            },
            "台灣吃飯大學 新款": {
                colors: ["黑", "白", "灰"],
                sizes: ["S", "M", "L", "XL", "2XL"],
                price: 590
            },
            "台灣吃飯大學帆布袋": {
                colors: ["白"],
                sizes: ["統一尺寸"],
                price: 250
            },
            "勝利的精子": {
                colors: ["白"],
                sizes: ["S", "M", "L", "XL", "2XL"],
                price: 550
            }
        };

        // 訂單項目陣列
        let orderItems = [];
        let totalPrice = 0;

        // DOM元素
        const styleSelect = document.getElementById('style');
        const colorSelect = document.getElementById('color');
        const sizeSelect = document.getElementById('size');
        const quantityInput = document.getElementById('quantity');
        const addItemButton = document.getElementById('addItem');
        const orderItemsContainer = document.getElementById('orderItems');
        const totalPriceElement = document.getElementById('totalPrice');
        const submitOrderButton = document.getElementById('submitOrder');

        // 監聽款式選擇變更
        styleSelect.addEventListener('change', function() {
            const selectedStyle = this.value;
            
            // 重設顏色和尺寸選項
            colorSelect.innerHTML = '<option value="">請選擇顏色</option>';
            sizeSelect.innerHTML = '<option value="">請選擇尺寸</option>';
            
            if (selectedStyle) {
                // 啟用顏色選擇
                colorSelect.disabled = false;
                
                // 加入顏色選項
                products[selectedStyle].colors.forEach(color => {
                    const option = document.createElement('option');
                    option.value = color;
                    option.textContent = color;
                    colorSelect.appendChild(option);
                });
                
                // 加入尺寸選項
                products[selectedStyle].sizes.forEach(size => {
                    const option = document.createElement('option');
                    option.value = size;
                    option.textContent = size;
                    sizeSelect.appendChild(option);
                });
                
                // 啟用尺寸選擇和數量輸入
                sizeSelect.disabled = false;
                quantityInput.disabled = false;
            } else {
                // 如果沒有選擇款式，則停用其他選項
                colorSelect.disabled = true;
                sizeSelect.disabled = true;
                quantityInput.disabled = true;
            }
        });

        // 加入訂購項目按鈕
        addItemButton.addEventListener('click', function() {
            const style = styleSelect.value;
            const color = colorSelect.value;
            const size = sizeSelect.value;
            const quantity = parseInt(quantityInput.value);
            
            // 驗證表單
            if (!style || !color || !size || !quantity || quantity < 1) {
                alert('請完整填寫訂購項目資訊');
                return;
            }
            
            // 計算項目價格
            const price = products[style].price;
            const itemTotal = price * quantity;
            
            // 創建訂單項目對象
            const orderItem = {
                style,
                color,
                size,
                quantity,
                price,
                itemTotal
            };
            
            // 將項目加入訂單
            orderItems.push(orderItem);
            
            // 更新 UI
            renderOrderItems();
            updateTotalPrice();
            
            // 重設選項
            styleSelect.selectedIndex = 0;
            colorSelect.innerHTML = '<option value="">請先選擇款式</option>';
            colorSelect.disabled = true;
            sizeSelect.innerHTML = '<option value="">請先選擇款式</option>';
            sizeSelect.disabled = true;
            quantityInput.value = 1;
            quantityInput.disabled = true;
        });

        // 渲染訂單項目
        function renderOrderItems() {
            orderItemsContainer.innerHTML = '';
            
            orderItems.forEach((item, index) => {
                const orderItemElement = document.createElement('div');
                orderItemElement.className = 'order-item';
                orderItemElement.innerHTML = `
                    <p>款式: ${item.style}</p>
                    <p>顏色: ${item.color}</p>
                    <p>尺寸: ${item.size}</p>
                    <p>數量: ${item.quantity}</p>
                    <p>單價: $${item.price}</p>
                    <p>小計: $${item.itemTotal}</p>
                    <button type="button" class="remove-btn" data-index="${index}">移除</button>
                `;
                orderItemsContainer.appendChild(orderItemElement);
            });
            
            // 為移除按鈕添加事件監聽
            document.querySelectorAll('.remove-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    orderItems.splice(index, 1);
                    renderOrderItems();
                    updateTotalPrice();
                });
            });
        }

        // 更新總價
        function updateTotalPrice() {
            totalPrice = orderItems.reduce((sum, item) => sum + item.itemTotal, 0);
            totalPriceElement.textContent = totalPrice;
        }

        // 提交訂單
        submitOrderButton.addEventListener('click', function() {
            // 檢查是否有訂單項目
            if (orderItems.length === 0) {
                alert('請至少加入一個訂購項目');
                return;
            }
            
            // 檢查個人資料是否完整
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const department = document.getElementById('department').value;
            const lineId = document.getElementById('lineId').value;
            const email = document.getElementById('email').value;
            
            if (!name || !phone || !department || !lineId || !email) {
                alert('請完整填寫個人資料');
                return;
            }
            
            // 建立訂單資料物件
            const orderData = {
                personalInfo: {
                    name,
                    phone,
                    department,
                    lineId,
                    email
                },
                items: orderItems,
                totalPrice
            };
            
            // 將訂單資料轉為 JSON 字串
            const orderDataJson = JSON.stringify(orderData, null, 2);
            
            // 這裡可以將訂單資料傳送到伺服器
            // 但由於題目要求儲存在檔案中，我們先用 console.log 來示範
            console.log('訂單資料:', orderDataJson);
            
            // 將訂單資料存為檔案 (在實際環境中，這段會由後端處理)
            // 由於瀏覽器安全限制，直接下載檔案
            const blob = new Blob([orderDataJson], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `order_${Date.now()}.json`;
            a.click();
            
            alert('訂單已提交成功！');
            
            // 重設表單
            document.getElementById('orderForm').reset();
            orderItems = [];
            renderOrderItems();
            updateTotalPrice();
            colorSelect.disabled = true;
            sizeSelect.disabled = true;
            quantityInput.disabled = true;
        });
    </script>
</body>
</html>